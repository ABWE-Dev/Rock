// <copyright>
// Copyright by Central Christian Church
//
// Licensed under the Rock Community License (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.rockrms.com/license
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// </copyright>
//
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using Rock.Plugin;
namespace com.centralaz.Finance.Migrations
{
    [MigrationNumber( 2, "1.5.1" )]
    public class ContributionStatementTemplate : Migration
    {
        public override void Up()
        {
            Sql( @"CREATE PROCEDURE [dbo].[spFinance_GetGivingGroupTransactions]
	@StartDate datetime
	, @EndDate datetime
	, @Account1Id int
	, @Account2Id int
	, @Account3Id int
	, @Account4Id int
	, @MinimumAmount decimal
	, @ChapterNumber int
	, @ChapterSize int
AS
BEGIN
DECLARE @cTRANSACTION_TYPE_CONTRIBUTION uniqueidentifier = '2D607262-52D6-4724-910D-5C6E8FB89ACC'
DECLARE @transactionTypeContributionId int = (select top 1 Id from DefinedValue where [Guid] = @cTRANSACTION_TYPE_CONTRIBUTION)
DECLARE @cLOCATION_TYPE_HOME uniqueidentifier = '8C52E53C-2A66-435A-AE6E-5EE307D9A0DC'
DECLARE @cLOCATION_TYPE_WORK uniqueidentifier = 'E071472A-F805-4FC4-917A-D5E3C095C35C'
DECLARE @cGROUPTYPE_FAMILY uniqueidentifier = '790E3215-3B10-442B-AF69-616C0DCB998E'

Declare @givingIds table(
GivingId nvarchar(50)
)

insert into @givingIds
select GivingId from (
	select GivingId, row_number() over (order by PostalCode) as 'rowNumber'
	from (
		select p.GivingId, max(l.PostalCode) as 'PostalCode'
		from FinancialTransaction ft
		join FinancialTransactionDetail ftd on ftd.TransactionId = ft.Id
		join PersonAlias pa on ft.AuthorizedPersonAliasId = pa.Id
		join Person p on pa.PersonId = p.Id		
		JOIN [GroupMember] [gm] ON [gm].[PersonId] = [p].[Id]
		JOIN [Group] [g] ON [gm].[GroupId] = [g].[Id]
		Join [GroupLocation] gl on gl.GroupId = g.Id
		JOIN [Location] [l] ON [l].[Id] = [gl].[LocationId]
		Where ft.TransactionTypeValueId = @transactionTypeContributionId
		and (@startDate is null or ft.TransactionDateTime >= @StartDate)
		and ( @endDate is null or ft.TransactionDateTime < @EndDate)				
		and ( ( p.GivingGroupId is null AND [g].[GroupTypeId] = (SELECT Id FROM GroupType WHERE [Guid] = @cGROUPTYPE_FAMILY)) or p.GivingGroupId = g.Id)
		and [gl].[IsMailingLocation] = 1
		AND [gl].[GroupLocationTypeValueId] = (SELECT Id FROM DefinedValue WHERE [Guid] = @cLOCATION_TYPE_HOME)
		group by GivingId
		having sum(ftd.Amount) >= @MinimumAmount		
		) g
	)og
where rowNumber between (@ChapterNumber-1)*@ChapterSize and @ChapterNumber*@ChapterSize
 
Select
	p.GivingId as 'GivingId',
	ft.TransactionCode as 'TransactionCode',
	ft.TransactionDateTime as 'TransactionDateTime',
	Sum(case when ftd.AccountId = @Account1Id then ftd.Amount end) as 'Account 1 Sum',
	Sum(case when ftd.AccountId = @Account2Id then ftd.Amount end) as 'Account 2 Sum',
	Sum(case when ftd.AccountId = @Account3Id then ftd.Amount end) as 'Account 3 Sum',
	Sum(case when ftd.AccountId = @Account4Id then ftd.Amount end) as 'Account 4 Sum',
	Sum(case when (ftd.AccountId != @Account1Id and
	 ftd.AccountId != @Account2Id and
	  ftd.AccountId != @Account3Id and
	   ftd.AccountId != @Account4Id  )then ftd.Amount end) as 'Other Sum',
	Sum(ftd.Amount) as 'Total Sum'
from FinancialTransaction ft
join FinancialTransactionDetail ftd on ftd.TransactionId = ft.Id
join PersonAlias pa on ft.AuthorizedPersonAliasId = pa.Id
join Person p on pa.PersonId = p.Id
Where ft.TransactionTypeValueId = @transactionTypeContributionId
and (@startDate is null or ft.TransactionDateTime >= @StartDate)
and ( @endDate is null or ft.TransactionDateTime < @EndDate)
and p.GivingId in (select * from @givingIds)
group by ft.TransactionCode, ft.TransactionDateTime, p.GivingId
order by TransactionDateTime

SELECT * FROM (
    SELECT 
		pg.GivingId		
		, [pn].[PersonNames] [AddressPersonNames]
        , case when l.Id is null then 0 else 1 end [HasAddress]
		, [l].[Street1]
		, [l].[Street2]
		, [l].[City]
		, [l].[State]
		, [l].[PostalCode]
	FROM (
		-- Get distinct Giving Groups for Persons that have a specific GivingGroupId and have transactions that match the filter
		-- These are Persons that give as part of a Group.  For example, Husband and Wife
		SELECT DISTINCT
			null [PersonId] 
			, [g].[Id] [GroupId]
			,p.GivingId
		FROM  [Person] [p]
		INNER JOIN  [Group] [g] ON [p].[GivingGroupId] = [g].[Id]
        AND [p].GivingId in (SELECT GivingId FROM @givingIds)
		UNION
		-- Get Persons and their GroupId(s) that do not have GivingGroupId and have transactions that match the filter.        
		-- These are the persons that give as individuals vs as part of a group. We need the Groups (families they belong to) in order 
		-- to determine which address(es) the statements need to be mailed to 
		SELECT  
			[p].[Id] [PersonId],
			[g].[Id] [GroupId],
			p.givingId
		FROM [Person] [p]
		JOIN [GroupMember] [gm] ON [gm].[PersonId] = [p].[Id]
		JOIN [Group] [g] ON [gm].[GroupId] = [g].[Id]
		WHERE [p].[GivingGroupId] is null
		AND [g].[GroupTypeId] = (SELECT Id FROM GroupType WHERE [Guid] = @cGROUPTYPE_FAMILY)
		AND [p].GivingId IN (SELECT GivingId FROM @givingIds)
	) [pg]
	CROSS APPLY [ufnCrm_GetFamilyTitle]([pg].[PersonId], [pg].[GroupId], default, default) [pn]
	LEFT OUTER JOIN (
    SELECT l.*, gl.GroupId 
	from [GroupLocation] [gl] 
	LEFT OUTER JOIN [Location] [l] ON [l].[Id] = [gl].[LocationId]
	WHERE [gl].[IsMailingLocation] = 1
	AND [gl].[GroupLocationTypeValueId] = (SELECT Id FROM DefinedValue WHERE [Guid] = @cLOCATION_TYPE_HOME)
        ) [l] 
        ON [l].[GroupId] = [pg].[GroupId]
    ) n
    WHERE n.HasAddress = 1
    ORDER BY PostalCode
	OPTION (RECOMPILE);

END" );
            // Add Binary File Type
            RockMigrationHelper.UpdateBinaryFileType( Rock.SystemGuid.EntityType.STORAGE_PROVIDER_DATABASE, "Finance Document", "Secured Document for use by the Finance Team", "fa fa-files-o", "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", false, true );

            // add security to the document
            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 0, "View", true, Rock.SystemGuid.Group.GROUP_FINANCE_ADMINISTRATORS, Rock.Model.SpecialRole.None, "64BB30E8-5104-4FC0-8074-B93A98A7E9CA" );
            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 1, "View", true, Rock.SystemGuid.Group.GROUP_FINANCE_USERS, Rock.Model.SpecialRole.None, "392C7998-9382-4A31-B43E-24B3CC73E1FE" );
            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 2, "View", true, Rock.SystemGuid.Group.GROUP_ADMINISTRATORS, Rock.Model.SpecialRole.None, "7C98E5FF-8F3D-471D-81EB-26EBBC419926" );
            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 3, "View", false, "", Rock.Model.SpecialRole.AllUsers, "D726A6CD-96E3-418A-8D4B-603F2DA2C031" );

            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 0, "Edit", true, Rock.SystemGuid.Group.GROUP_FINANCE_ADMINISTRATORS, Rock.Model.SpecialRole.None, "F16639AE-B7A8-442B-94FE-F0E1E3C8CA03" );
            RockMigrationHelper.AddSecurityAuthForBinaryFileType( "FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", 1, "Edit", true, Rock.SystemGuid.Group.GROUP_FINANCE_USERS, Rock.Model.SpecialRole.None, "8C1D179D-E3DC-485D-B83D-636D9EBC2ABC" );

            // Make sure the merge template's category exists
            RockMigrationHelper.UpdateCategory( Rock.SystemGuid.EntityType.MERGE_TEMPLATE, "Accounting Team", "fa fa-fw fa-money", "", "CEDD0FD9-1EF2-4370-90CB-A9E55531CB99" );

            // Add the Merge Template
            Sql( @"DECLARE @BinaryFileTypeMergeTemplate INT = (
        SELECT TOP 1 Id
        FROM BinaryFileType
        WHERE [Guid] = 'BD63EC0C-2DF8-4C55-97E3-616870C67C59'
        )
    ,@StorageEntityTypeDatabase INT = (
        SELECT TOP 1 Id
        FROM EntityType
        WHERE NAME = 'Rock.Storage.Provider.Database'
        )

INSERT INTO [dbo].[BinaryFile] (
    [IsTemporary]
    ,[IsSystem]
    ,[BinaryFileTypeId]
    ,[FileName]
    ,[MimeType]
    ,[Description]
    ,[StorageEntityTypeId]
    ,[Guid]
    )
VALUES (
    0
    ,0
    ,@BinaryFileTypeMergeTemplate
    ,'ContributionStatements.html'
    ,'text/html'
    ,NULL
    ,@StorageEntityTypeDatabase
    ,'488A487D-A693-4761-B9FD-214C1D0EB32D'
    )

DECLARE @binaryFileId INT = (
        SELECT TOP 1 Id
        FROM BinaryFile
        WHERE [Guid] = '488A487D-A693-4761-B9FD-214C1D0EB32D'
        )

INSERT INTO [dbo].[BinaryFileData] (
    [Id]
    ,[Content]
    ,[Guid]
    )
VALUES (
    @binaryFileId
    ,0x3C68746D6C3E0D0A3C686561643E0D0A202020203C7469746C653E47726F757020526F737465723C2F7469746C653E0D0A202020203C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F6373732220687265663D2268747470733A2F2F6D617863646E2E626F6F74737472617063646E2E636F6D2F626F6F7473747261702F332E332E352F6373732F626F6F7473747261702E6D696E2E637373223E0D0A202020203C6C696E6B2072656C3D227374796C6573686565742220747970653D22746578742F63737322206D656469613D227072696E742220687265663D2268747470733A2F2F6D617863646E2E626F6F74737472617063646E2E636F6D2F626F6F7473747261702F332E332E352F6373732F626F6F7473747261702E6D696E2E637373223E0D0A3C2F686561643E0D0A3C626F64793E0D0A202020203C7374796C653E0D0A20202020202020207468207B0D0A202020202020202020202020626F726465722D626F74746F6D3A2031707420736F6C696420626C61636B3B0D0A20202020202020207D0D0A0D0A2020202020202020237072696E744F6E6C79207B0D0A202020202020202020202020646973706C61793A206E6F6E653B0D0A20202020202020207D0D0A0D0A2020202020202020406D65646961207072696E74207B0D0A202020202020202020202020237072696E744F6E6C79207B0D0A20202020202020202020202020202020646973706C61793A20626C6F636B3B0D0A2020202020202020202020207D0D0A20202020202020207D0D0A202020203C2F7374796C653E0D0A202020203C64697620636C6173733D22636F6E7461696E6572223E0D0A20202020202020207B2520666F72206164647265737320696E2041646472657373657320257D0D0A20202020202020203C646976207374796C653D22706167652D627265616B2D61667465723A20616C776179733B20706F736974696F6E3A72656C61746976653B2077696474683A313030253B6865696768743A313030253B20626F726465723A7468696E3B626F726465722D636F6C6F723A626C61636B3B223E0D0A2020202020202020202020207B252061737369676E2066726F6E7450616765203D203120257D0D0A2020202020202020202020203C646976207374796C653D22706F736974696F6E3A6162736F6C7574653B746F703A302E3235696E3B77696474683A313030253B223E0D0A202020202020202020202020202020203C646976207374796C653D22666C6F61743A72696768743B626F726465723A7468696E3B626F726465722D636F6C6F723A626C61636B3B223E0D0A20202020202020202020202020202020202020203C6834207374796C653D22666F6E742D73697A653A313270743B746578742D616C69676E3A72696768743B77696474683A342E35696E3B223E0D0A202020202020202020202020202020202020202020202020436F6E747269627574696F6E2053756D6D61727920666F72207B7B616464726573732E4E616D65737D7D3C6272202F3E0D0A2020202020202020202020202020202020202020202020207B7B20537461727444617465207C20446174653A20274D2F642F7979797927207D7D202D207B7B20456E6444617465207C20446174653A20274D2F642F7979797927207D7D0D0A20202020202020202020202020202020202020203C2F68343E0D0A202020202020202020202020202020203C2F6469763E0D0A202020202020202020202020202020203C646976207374796C653D2277696474683A32696E3B223E0D0A20202020202020202020202020202020202020203C696D67207372633D22496D616765732F43656E7472616C5F4C6F676F5F426C61636B5F7267625F3135305F38322E6A706722202F3E0D0A20202020202020202020202020202020202020203C70207374796C653D22666F6E742D73697A653A313070743B20746578742D616C69676E3A6C6566743B223E0D0A202020202020202020202020202020202020202020202020393333204E2E204C696E647361792052642E3C6272202F3E0D0A2020202020202020202020202020202020202020202020204D6573612C20415A2038353231333C6272202F3E0D0A20202020202020202020202020202020202020203C2F703E0D0A202020202020202020202020202020203C2F6469763E0D0A2020202020202020202020203C2F6469763E0D0A2020202020202020202020203C646976207374796C653D22706F736974696F6E3A6162736F6C7574653B746F703A32696E3B77696474683A313030253B223E0D0A202020202020202020202020202020203C6834207374796C653D22666F6E742D73697A653A313270743B746578742D616C69676E3A6C6566743B223E0D0A20202020202020202020202020202020202020207B7B616464726573732E4E616D65737D7D3C6272202F3E0D0A20202020202020202020202020202020202020207B7B616464726573732E537472656574317D7D207B7B616464726573732E537472656574327D7D3C6272202F3E0D0A20202020202020202020202020202020202020207B7B616464726573732E436974797D7D2C207B7B616464726573732E53746174657D7D207B7B616464726573732E506F7374616C436F64657D7D0D0A202020202020202020202020202020203C2F68343E0D0A2020202020202020202020203C2F6469763E0D0A2020202020202020202020207B252061737369676E207472616E73616374696F6E436F756E74203D203020257D0D0A2020202020202020202020207B252061737369676E20666972737450616765456E64203D20333620257D0D0A2020202020202020202020207B252061737369676E207365636F6E6450616765456E64203D20343920257D0D0A2020202020202020202020207B252061737369676E20676976696E674964203D20616464726573732E476976696E67496420257D0D0A2020202020202020202020207B252061737369676E2067726F757065645472616E73616374696F6E203D205472616E73616374696F6E73207C2057686572653A20274B6579272C20676976696E674964207C20466972737420257D0D0A2020202020202020202020203C646976207374796C653D22706F736974696F6E3A6162736F6C7574653B746F703A33696E3B223E0D0A202020202020202020202020202020203C7461626C65207374796C653D22666F6E742D73697A653A3970743B223E0D0A20202020202020202020202020202020202020203C74723E0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A6C6566743B77696474683A312E35696E3B223E0D0A20202020202020202020202020202020202020202020202020202020446174650D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7431546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74312E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7432546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74322E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7433546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74332E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7434546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74342E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4F74686572546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020204F746865720D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B223E0D0A202020202020202020202020202020202020202020202020202020205472616E73616374696F6E20436F64650D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B223E0D0A20202020202020202020202020202020202020202020202020202020546F74616C20416D6F756E740D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A20202020202020202020202020202020202020203C2F74723E0D0A20202020202020202020202020202020202020207B2520666F72207472616E73616374696F6E20696E2067726F757065645472616E73616374696F6E2E5472616E73616374696F6E7320257D0D0A20202020202020202020202020202020202020207B252061737369676E207472616E73616374696F6E436F756E74203D207472616E73616374696F6E436F756E74207C20506C75733A3120257D0D0A20202020202020202020202020202020202020207B252061737369676E207472616E73616374696F6E436F756E745365636F6E6450616765203D207472616E73616374696F6E436F756E74207C204D696E75733A20666972737450616765456E64207C204D6F64756C6F3A7365636F6E6450616765456E6420257D0D0A20202020202020202020202020202020202020207B25206966207472616E73616374696F6E436F756E74203D3D20666972737450616765456E64206F72207472616E73616374696F6E436F756E745365636F6E6450616765203D3D203020257D0D0A20202020202020202020202020202020202020207B252069662066726F6E7450616765203D3D203120257D0D0A20202020202020202020202020202020202020207B252061737369676E2066726F6E7450616765203D203020257D0D0A20202020202020202020202020202020202020207B2520656C736520257D0D0A20202020202020202020202020202020202020207B252061737369676E2066726F6E7450616765203D203120257D0D0A20202020202020202020202020202020202020207B2520656E64696620257D0D0A202020202020202020202020202020203C2F7461626C653E0D0A2020202020202020202020203C2F6469763E0D0A20202020202020203C2F6469763E0D0A20202020202020203C646976207374796C653D22706167652D627265616B2D61667465723A20616C776179733B706F736974696F6E3A72656C61746976653B77696474683A313030253B6865696768743A313030253B20626F726465723A7468696E3B20626F726465722D636F6C6F723A626C61636B3B223E0D0A2020202020202020202020203C646976207374796C653D22706F736974696F6E3A6162736F6C7574653B77696474683A313030253B746F703A2E3235696E3B626F726465723A7468696E3B626F726465722D636F6C6F723A626C61636B3B223E0D0A202020202020202020202020202020203C6834207374796C653D22666F6E742D73697A653A313270743B666C6F61743A72696768743B746578742D616C69676E3A72696768743B2077696474683A342E35696E3B223E0D0A2020202020202020202020202020202020202020436F6E747269627574696F6E2053756D6D61727920666F72207B7B616464726573732E4E616D65737D7D3C6272202F3E0D0A20202020202020202020202020202020202020207B7B20537461727444617465207C20446174653A20274D2F642F7979797927207D7D202D207B7B20456E6444617465207C20446174653A20274D2F642F7979797927207D7D0D0A202020202020202020202020202020203C2F68343E0D0A2020202020202020202020203C2F6469763E0D0A2020202020202020202020203C646976207374796C653D22706F736974696F6E3A6162736F6C7574653B746F703A31696E3B223E0D0A202020202020202020202020202020203C7461626C65207374796C653D22666F6E742D73697A653A3970743B223E0D0A20202020202020202020202020202020202020203C74723E0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A6C6566743B77696474683A312E35696E3B223E0D0A20202020202020202020202020202020202020202020202020202020446174650D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7431546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74312E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7432546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74322E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7433546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74332E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7434546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B204163636F756E74342E4E616D657D7D0D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4F74686572546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020204F746865720D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B223E0D0A202020202020202020202020202020202020202020202020202020205472616E73616374696F6E20436F64650D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A2020202020202020202020202020202020202020202020203C7468207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B223E0D0A20202020202020202020202020202020202020202020202020202020546F74616C20416D6F756E740D0A2020202020202020202020202020202020202020202020203C2F74683E0D0A20202020202020202020202020202020202020203C2F74723E0D0A20202020202020202020202020202020202020207B2520656E64696620257D0D0A20202020202020202020202020202020202020203C74723E0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A6C6566743B77696474683A312E35696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E5472616E73616374696F6E4461746554696D65207C20446174653A274D4D2F64642F797927207D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7431546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E4163636F756E7431416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E4163636F756E7431416D6F756E74207C20466F726D6174417343757272656E63797D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7432546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E4163636F756E7432416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E4163636F756E7432416D6F756E74207C20466F726D6174417343757272656E63797D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7433546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E4163636F756E7433416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E4163636F756E7433416D6F756E74207C20466F726D6174417343757272656E63797D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7434546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E4163636F756E7434416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E4163636F756E7434416D6F756E74207C20466F726D6174417343757272656E63797D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4F74686572546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E4F74686572416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B7472616E73616374696F6E2E4F74686572416D6F756E74207C20466F726D6174417343757272656E63797D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B646973706C61793A626C6F636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E5472616E73616374696F6E436F64657D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B223E0D0A202020202020202020202020202020202020202020202020202020207B25206966207472616E73616374696F6E2E546F74616C5472616E73616374696F6E416D6F756E7420213D203020257D0D0A202020202020202020202020202020202020202020202020202020207B7B207472616E73616374696F6E2E546F74616C5472616E73616374696F6E416D6F756E74207C20466F726D6174417343757272656E6379207D7D0D0A202020202020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A20202020202020202020202020202020202020203C2F74723E0D0A20202020202020202020202020202020202020207B2520656E64666F7220257D0D0A0D0A20202020202020202020202020202020202020203C74723E0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A6C6566743B77696474683A312E35696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A20202020202020202020202020202020202020202020202020202020546F74616C0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7431546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B2067726F757065645472616E73616374696F6E2E4163636F756E7431546F74616C207C20466F726D6174417343757272656E63797D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7432546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B2067726F757065645472616E73616374696F6E2E4163636F756E7432546F74616C207C20466F726D6174417343757272656E63797D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7433546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B2067726F757065645472616E73616374696F6E2E4163636F756E7433546F74616C207C20466F726D6174417343757272656E63797D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4163636F756E7434546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B2067726F757065645472616E73616374696F6E2E4163636F756E7434546F74616C207C20466F726D6174417343757272656E63797D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020207B252069662067726F757065645472616E73616374696F6E2E4F74686572546F74616C203E203020257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A2E383735696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B67726F757065645472616E73616374696F6E2E4F74686572546F74616C207C20466F726D6174417343757272656E63797D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A2020202020202020202020202020202020202020202020207B2520656E64696620257D0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E3C2F74643E0D0A2020202020202020202020202020202020202020202020203C7464207374796C653D22746578742D616C69676E3A72696768743B2077696474683A31696E3B626F726465722D746F703A2031707420736F6C696420626C61636B3B223E0D0A202020202020202020202020202020202020202020202020202020207B7B67726F757065645472616E73616374696F6E2E5472616E73616374696F6E546F74616C207C20466F726D6174417343757272656E6379207D7D0D0A2020202020202020202020202020202020202020202020203C2F74643E0D0A20202020202020202020202020202020202020203C2F74723E0D0A202020202020202020202020202020203C2F7461626C653E0D0A202020202020202020202020202020203C6272202F3E0D0A202020202020202020202020202020203C646976207374796C653D22666F6E742D73697A653A3870743B223E0D0A20202020202020202020202020202020202020203C703E5468616E6B20796F7520666F7220796F757220636F6E74696E7565642067656E65726F757320737570706F7274206F6620746865206D696E6973747279206F662043656E7472616C2043687269737469616E20436875726368213C2F703E0D0A20202020202020202020202020202020202020203C703E0D0A2020202020202020202020202020202020202020202020202257652068617665206E6F742070726F766964656420796F75207769746820616E7920676F6F6473206F7220736572766963657320696E2065786368616E676520666F72207468697320636F6E747269627574696F6E2E0D0A202020202020202020202020202020202020202020202020576520686176652070726F766964656420796F75207769746820696E74616E6769626C652072656C6967696F75732062656E6566697473206F6E6C7920616E6420636F6E73697374656E742077697468207468652074656E657473206F66206F757220666169746820616E642070726163746963652C20696E636964656E74616C2074616E6769626C652062656E65666974732E220D0A20202020202020202020202020202020202020203C2F703E0D0A20202020202020202020202020202020202020203C6272202F3E0D0A20202020202020202020202020202020202020203C703E0D0A202020202020202020202020202020202020202020202020466F7220796F757220636F6E76656E69656E636520796F752063616E2067697665206F6E6C696E6520616E64207669657720796F757220636F6E747269627574696F6E732E20476F20746F2063656E7472616C617A2E636F6D20616E6420636C69636B206F6E20676976652E0D0A202020202020202020202020202020202020202020202020496620796F75206861766520616E79207175657374696F6E73206F7220636F6E6365726E7320726567617264696E6720796F757220636F6E747269627574696F6E7320706C6561736520636F6E74616374204D61726C61204A6F686E736F6E206174203438302D3330352D37353030204578742032323236202847696C626572742F20517565656E20437265656B2F204168776174756B6565290D0A2020202020202020202020202020202020202020202020206F722053796C7669612047726561736F6E206174203438302D3932342D343934362045787420323438284D657361292E0D0A20202020202020202020202020202020202020203C2F703E0D0A202020202020202020202020202020203C2F6469763E0D0A2020202020202020202020203C2F6469763E0D0A20202020202020203C2F6469763E0D0A20202020202020207B252069662066726F6E7450616765203D3D203120257D0D0A20202020202020203C6469762069643D227072696E744F6E6C7922207374796C653D22706167652D627265616B2D61667465723A20616C776179733B706F736974696F6E3A72656C61746976653B77696474683A313030253B6865696768743A313030253B20626F726465723A7468696E3B626F726465722D636F6C6F723A626C61636B3B223E0D0A20202020202020203C2F6469763E0D0A20202020202020207B2520656E64696620257D0D0A20202020202020207B2520656E64666F7220257D0D0A202020203C2F6469763E0D0A3C2F626F64793E0D0A3C2F68746D6C3E0D0A
    ,'8305A1F1-FA85-486D-A77C-DB34D13CF991'
    )

DECLARE @HtmlMergeTemplateType INT = (
        SELECT TOP 1 Id
        FROM EntityType
        WHERE NAME = 'Rock.MergeTemplates.HtmlMergeTemplateType'
        )
    ,@AccountingCategory INT = (
        SELECT TOP 1 Id
        FROM Category
        WHERE [Guid] = 'CEDD0FD9-1EF2-4370-90CB-A9E55531CB99'
        )

INSERT INTO [dbo].[MergeTemplate] (
    [Name]
    ,[Description]
    ,[TemplateBinaryFileId]
    ,[MergeTemplateTypeEntityTypeId]
    ,[CategoryId]
    ,[Guid]
    )
VALUES (
    'Year-End Statement Contributions'
    ,''
    ,@binaryFileId
    ,@HtmlMergeTemplateType
    ,@AccountingCategory
    ,'44C1A40E-01F4-4332-A123-27FC918B3E2F'
    )
" );

            RockMigrationHelper.UpdateSystemEmail( "Finance", "Contribution Statements Available", "", "", "", "", "", "Contribution Statements Available", @"{{ 'Global' | Attribute:'EmailHeader' }}

           <p> {{ FirstName }},</p>
            <p>
            The contribution statements that you have requested have been generated and are available for viewing at <a href='{{ 'Global' | Attribute:'InternalApplicationRoot' }}ContributionStatements'>{{ 'Global' | Attribute:'InternalApplicationRoot' }}ContributionStatements</a>.
</ p >
            {{ 'Global' | Attribute:'EmailFooter' }}", "67CE0516-FC3C-46EE-8546-FC789B264C4F" );

            // Page: Contribution Statements
            RockMigrationHelper.AddPage( "18C9E5C3-3E28-4AA3-84F6-78CD4EA2DD3C", "D65F783D-87A9-4CC9-8110-E83466A0EADB", "Contribution Statements", "", "84F036CF-C82C-4C29-B7A2-30DD259D73F6", "" ); // Site:Rock RMS
            RockMigrationHelper.AddPageRoute( "84F036CF-C82C-4C29-B7A2-30DD259D73F6", "ContributionStatements" );
            RockMigrationHelper.UpdateBlockType( "Contribution Statement Template Entry", "Used for merging contribution data into output documents, such as Word, Html, using a pre-defined template.", "~/Plugins/com_centralaz/Finance/ContributionStatementTemplateEntry.ascx", "com_centralaz > Finance", "BD245DFC-F3AE-4025-BCA5-819A4668DDC0" );
            RockMigrationHelper.UpdateBlockType( "Binary File Link List", "Shows a list of all binary files, with links.", "~/Plugins/com_centralaz/Finance/BinaryFileLinkList.ascx", "com_centralaz > Finance", "4D2141B9-2061-41E3-8517-667E3D1C344F" );
            RockMigrationHelper.AddBlock( "84F036CF-C82C-4C29-B7A2-30DD259D73F6", "", "BD245DFC-F3AE-4025-BCA5-819A4668DDC0", "Contribution Statement Template Entry", "Main", "", "", 0, "2078FFF0-64E8-41D2-8643-88A3E05C761C" );
            RockMigrationHelper.AddBlock( "84F036CF-C82C-4C29-B7A2-30DD259D73F6", "", "4D2141B9-2061-41E3-8517-667E3D1C344F", "Binary File Link List", "Main", "", "", 1, "0E78D571-F8BB-4741-A08D-802A5C201ED6" );
            RockMigrationHelper.AddBlockTypeAttribute( "BD245DFC-F3AE-4025-BCA5-819A4668DDC0", "A75DFC58-7A1B-4799-BF31-451B2BBE38FF", "Database Timeout", "DatabaseTimeout", "", "The number of seconds to wait before reporting a database timeout.", 0, @"180", "091D81E1-AA56-4D4B-BCE0-CBD30918C903" );
            RockMigrationHelper.AddBlockTypeAttribute( "BD245DFC-F3AE-4025-BCA5-819A4668DDC0", "09EC7F0D-3505-4090-B010-ABA68CB9B904", "File Type", "FileType", "", "The file type used to save the contribution statements.", 0, @"FC7218EE-EA28-4EA4-8C3D-F30750A2FE59", "567B845B-C809-4DDB-AA8D-30C53A180D69" );
            RockMigrationHelper.AddBlockTypeAttribute( "BD245DFC-F3AE-4025-BCA5-819A4668DDC0", "08F3003B-F3E2-41EC-BDF1-A2B7AC2908CF", "Notify Requester Email", "NotifyRequesterEmail", "", "The system email used to notify the requester that the statements have been generated", 0, @"", "8586D5C4-25BB-4F12-9AC6-8094FC261754" );
            RockMigrationHelper.AddBlockTypeAttribute( "4D2141B9-2061-41E3-8517-667E3D1C344F", "BD53F9C9-EBA9-4D3F-82EA-DE5DD34A8108", "Detail Page", "DetailPage", "", "", 0, @"", "EBDA60C0-3BE7-4FB8-9BFD-6EC169BEE800" );
            RockMigrationHelper.AddBlockTypeAttribute( "4D2141B9-2061-41E3-8517-667E3D1C344F", "09EC7F0D-3505-4090-B010-ABA68CB9B904", "Binary File Type", "BinaryFileType", "", "", 0, @"", "F8E3923E-CB42-4285-9B95-13078BE7CDAB" );
            RockMigrationHelper.AddBlockAttributeValue( "2078FFF0-64E8-41D2-8643-88A3E05C761C", "091D81E1-AA56-4D4B-BCE0-CBD30918C903", @"180" ); // Database Timeout
            RockMigrationHelper.AddBlockAttributeValue( "2078FFF0-64E8-41D2-8643-88A3E05C761C", "567B845B-C809-4DDB-AA8D-30C53A180D69", @"fc7218ee-ea28-4ea4-8c3d-f30750a2fe59" ); // File Type
            RockMigrationHelper.AddBlockAttributeValue( "2078FFF0-64E8-41D2-8643-88A3E05C761C", "8586D5C4-25BB-4F12-9AC6-8094FC261754", @"67ce0516-fc3c-46ee-8546-fc789b264c4f" ); // Notify Requester Email
            RockMigrationHelper.AddBlockAttributeValue( "0E78D571-F8BB-4741-A08D-802A5C201ED6", "EBDA60C0-3BE7-4FB8-9BFD-6EC169BEE800", @"e594a0f8-b98b-4e1d-97af-6c67c54fd432" ); // Detail Page
            RockMigrationHelper.AddBlockAttributeValue( "0E78D571-F8BB-4741-A08D-802A5C201ED6", "F8E3923E-CB42-4285-9B95-13078BE7CDAB", @"fc7218ee-ea28-4ea4-8c3d-f30750a2fe59" ); // Binary File Type

            // Page: Contribution Statement Detail
            RockMigrationHelper.AddPage( "84F036CF-C82C-4C29-B7A2-30DD259D73F6", "D65F783D-87A9-4CC9-8110-E83466A0EADB", "Contribution Statement Detail", "", "E594A0F8-B98B-4E1D-97AF-6C67C54FD432", "" ); // Site:Rock RMS
            RockMigrationHelper.AddBlock( "E594A0F8-B98B-4E1D-97AF-6C67C54FD432", "", "B97B2E51-5C9C-459B-999F-C7797DAD8B69", "Binary File Detail", "Main", "", "", 0, "24D8732B-ADEB-4224-92D2-8C9BA43A2E67" );

        }
        public override void Down()
        {
            RockMigrationHelper.DeleteBlock( "24D8732B-ADEB-4224-92D2-8C9BA43A2E67" );
            RockMigrationHelper.DeletePage( "E594A0F8-B98B-4E1D-97AF-6C67C54FD432" ); //  Page: Contribution Statement Detail

            RockMigrationHelper.DeleteAttribute( "F8E3923E-CB42-4285-9B95-13078BE7CDAB" );
            RockMigrationHelper.DeleteAttribute( "EBDA60C0-3BE7-4FB8-9BFD-6EC169BEE800" );
            RockMigrationHelper.DeleteAttribute( "8586D5C4-25BB-4F12-9AC6-8094FC261754" );
            RockMigrationHelper.DeleteAttribute( "567B845B-C809-4DDB-AA8D-30C53A180D69" );
            RockMigrationHelper.DeleteAttribute( "091D81E1-AA56-4D4B-BCE0-CBD30918C903" );
            RockMigrationHelper.DeleteBlock( "0E78D571-F8BB-4741-A08D-802A5C201ED6" );
            RockMigrationHelper.DeleteBlock( "2078FFF0-64E8-41D2-8643-88A3E05C761C" );
            RockMigrationHelper.DeleteBlockType( "4D2141B9-2061-41E3-8517-667E3D1C344F" );
            RockMigrationHelper.DeleteBlockType( "BD245DFC-F3AE-4025-BCA5-819A4668DDC0" );
            RockMigrationHelper.DeletePage( "84F036CF-C82C-4C29-B7A2-30DD259D73F6" ); //  Page: Contribution Statements

            RockMigrationHelper.DeleteSystemEmail( "67CE0516-FC3C-46EE-8546-FC789B264C4F" );

            RockMigrationHelper.DeleteSecurityAuth( "D726A6CD-96E3-418A-8D4B-603F2DA2C031" );
            RockMigrationHelper.DeleteSecurityAuth( "7C98E5FF-8F3D-471D-81EB-26EBBC419926" );
            RockMigrationHelper.DeleteSecurityAuth( "392C7998-9382-4A31-B43E-24B3CC73E1FE" );
            RockMigrationHelper.DeleteSecurityAuth( "8C1D179D-E3DC-485D-B83D-636D9EBC2ABC" );
            RockMigrationHelper.DeleteSecurityAuth( "64BB30E8-5104-4FC0-8074-B93A98A7E9CA" );
            RockMigrationHelper.DeleteSecurityAuth( "F16639AE-B7A8-442B-94FE-F0E1E3C8CA03" );

            Sql( "DROP PROCEDURE [dbo].[spFinance_GetGivingGroupTransactions]" );

        }
    }
}
